$(function(){let t=new FileReader,f=new Image,n=!1,a={original:function(){},color_inverse:function(){var t=g(_,f.width,f.height);for(let a=0;a<t.data.length;a+=4)t.data[a]=255^t.data[a],t.data[a+1]=255^t.data[a+1],t.data[a+2]=255^t.data[a+2],t.data[a+3]=255;_.putImageData(t,0,0)},gray_bits:function(){var t=g(_,f.width,f.height);for(let a=0;a<t.data.length;a+=4)t.data[a]==t.data[a+1]&&t.data[a]==t.data[a+2]?t.data[a]=t.data[a+1]=t.data[a+2]=255:t.data[a]=t.data[a+1]=t.data[a+2]=0,t.data[a+3]=255;_.putImageData(t,0,0)},random_color_map:function(){var t=g(_,f.width,f.height),n=Math.randomInt(1,255),e=Math.randomInt(1,255),d=Math.randomInt(1,255),o=Math.randomInt(1,255),l=Math.randomInt(1,255),i=Math.randomInt(1,255),h=Math.randomInt(1,255),r=Math.randomInt(1,255),u=Math.randomInt(1,255);for(let a=0;a<t.data.length;a+=4){var c=((t.data[a]*h*h^u)+r<<16)+((t.data[a+1]*o*o^i)+l<<8)+((t.data[a+2]*n*n^d)+e)+((255&t.data[a+3])<<24);t.data[a]=(16711680&c)>>16,t.data[a+1]=(65280&c)>>8,t.data[a+2]=255&c,t.data[a+3]=255}_.putImageData(t,0,0)},full_rgb:function(t){var n=g(_,f.width,f.height);for(let a=t;a<n.data.length;a+=4)t&&(n.data[a-t]=0),t-1&&(n.data[a-t+1]=0),t-2&&(n.data[a-t+2]=0),n.data[a-t+3]=255;_.putImageData(n,0,0)},full_alpha:function(){var t=g(_,f.width,f.height);for(let a=0;a<t.data.length;a+=4)t.data[a]=t.data[a+3],t.data[a+1]=0,t.data[a+2]=0,t.data[a+3]=255;_.putImageData(t,0,0)},red_plane_0:function(){var t=g(_,f.width,f.height);for(let a=0;a<t.data.length;a+=4)t.data[a]%2==0?t.data[a]=t.data[a+1]=t.data[a+2]=0:t.data[a]=t.data[a+1]=t.data[a+2]=255,t.data[a+3]=255;_.putImageData(t,0,0)},green_plane_0:function(){var t=g(_,f.width,f.height);for(let a=1;a<t.data.length;a+=4)t.data[a]%2==0?t.data[a]=t.data[a-1]=t.data[a+1]=0:t.data[a]=t.data[a-1]=t.data[a+1]=255,t.data[a+2]=255;_.putImageData(t,0,0)},blue_plane_0:function(){var t=g(_,f.width,f.height);for(let a=2;a<t.data.length;a+=4)t.data[a]%2==0?t.data[a]=t.data[a-2]=t.data[a-1]=0:t.data[a]=t.data[a-2]=t.data[a-1]=255,t.data[a+1]=255;_.putImageData(t,0,0)},alpha_plane_0:function(){var t=g(_,f.width,f.height);for(let a=3;a<t.data.length;a+=4)t.data[a]%2==0?t.data[a-3]=t.data[a-2]=t.data[a-1]=0:t.data[a-3]=t.data[a-2]=t.data[a-1]=255,t.data[a]=255;_.putImageData(t,0,0)},red_plane_1:function(){var t=g(_,f.width,f.height);for(let a=0;a<t.data.length;a+=4)t.data[a]%4-t.data[a]%2==2?t.data[a]=t.data[a+1]=t.data[a+2]=255:t.data[a]=t.data[a+1]=t.data[a+2]=0,t.data[a+3]=255;_.putImageData(t,0,0)},green_plane_1:function(){var t=g(_,f.width,f.height);for(let a=1;a<t.data.length;a+=4)t.data[a]%4-t.data[a]%2==2?t.data[a]=t.data[a-1]=t.data[a+1]=255:t.data[a]=t.data[a-1]=t.data[a+1]=0,t.data[a+2]=255;_.putImageData(t,0,0)},blue_plane_1:function(){var t=g(_,f.width,f.height);for(let a=2;a<t.data.length;a+=4)t.data[a]%4-t.data[a]%2==2?t.data[a]=t.data[a-2]=t.data[a-1]=255:t.data[a]=t.data[a-2]=t.data[a-1]=0,t.data[a+1]=255;_.putImageData(t,0,0)},alpha_plane_1:function(){var t=g(_,f.width,f.height);for(let a=3;a<t.data.length;a+=4)t.data[a]%4-t.data[a]%2==2?t.data[a-3]=t.data[a-2]=t.data[a-1]=255:t.data[a-3]=t.data[a-2]=t.data[a-1]=0,t.data[a]=255;_.putImageData(t,0,0)},red_plane_2:function(){var t=g(_,f.width,f.height);for(let a=0;a<t.data.length;a+=4)t.data[a]%8-t.data[a]%4==4?t.data[a]=t.data[a+1]=t.data[a+2]=255:t.data[a]=t.data[a+1]=t.data[a+2]=0,t.data[a+3]=255;_.putImageData(t,0,0)},green_plane_2:function(){var t=g(_,f.width,f.height);for(let a=1;a<t.data.length;a+=4)t.data[a]%8-t.data[a]%4==4?t.data[a]=t.data[a-1]=t.data[a+1]=255:t.data[a]=t.data[a-1]=t.data[a+1]=0,t.data[a+2]=255;_.putImageData(t,0,0)},blue_plane_2:function(){var t=g(_,f.width,f.height);for(let a=2;a<t.data.length;a+=4)t.data[a]%8-t.data[a]%4==4?t.data[a]=t.data[a-2]=t.data[a-1]=255:t.data[a]=t.data[a-2]=t.data[a-1]=0,t.data[a+1]=255;_.putImageData(t,0,0)},alpha_plane_2:function(){var t=g(_,f.width,f.height);for(let a=3;a<t.data.length;a+=4)t.data[a]%8-t.data[a]%4==4?t.data[a-3]=t.data[a-2]=t.data[a-1]=255:t.data[a-3]=t.data[a-2]=t.data[a-1]=0,t.data[a]=255;_.putImageData(t,0,0)}},e=[{name:"original",showText:"原图",function:function(){a.original()}},{name:"color_inverse",showText:"反色",function:function(){a.color_inverse()}},{name:"gray_bits",showText:"Gray Bits",function:function(){a.gray_bits()}},{name:"random_color_map",showText:"Random Color Map 1",function:function(){a.random_color_map()}},{name:"random_color_map",showText:"Random Color Map 2",function:function(){a.random_color_map()}},{name:"full_red",showText:"Full Red",function:function(){a.full_rgb(0)}},{name:"full_green",showText:"Full Green",function:function(){a.full_rgb(1)}},{name:"full blue",showText:"Full Blue",function:function(){a.full_rgb(2)}},{name:"full_alpha",showText:"Full Alpha",function:function(){a.full_alpha()}},{name:"red_plane_0",showText:"Red Plane 0",function:function(){a.red_plane_0()}},{name:"green_plane_0",showText:"Green Plane 0",function:function(){a.green_plane_0()}},{name:"blue_plane_0",showText:"Blue Plane 0",function:function(){a.blue_plane_0()}},{name:"alpha_plane_0",showText:"Alpha Plane 0",function:function(){a.alpha_plane_0()}},{name:"red_plane_1",showText:"Red Plane 1",function:function(){a.red_plane_1()}},{name:"green_plane_1",showText:"Green Plane 1",function:function(){a.green_plane_1()}},{name:"blue_plane_1",showText:"Blue Plane 1",function:function(){a.blue_plane_1()}},{name:"alpha_plane_1",showText:"Alpha Plane 1",function:function(){a.alpha_plane_1()}},{name:"red_plane_2",showText:"Red Plane 2",function:function(){a.red_plane_2()}},{name:"green_plane_2",showText:"Green Plane 2",function:function(){a.green_plane_2()}},{name:"blue_plane_2",showText:"Blue Plane 2",function:function(){a.blue_plane_2()}},{name:"alpha_plane_2",showText:"Alpha Plane 2",function:function(){a.alpha_plane_2()}}],d={currentModeIndex:0,nextMode:function(){i(),this.currentModeIndex==e.length-1?this.currentModeIndex=0:this.currentModeIndex++,l(e[this.currentModeIndex].showText),e[this.currentModeIndex].function()},previousMode:function(){i(),0==this.currentModeIndex?this.currentModeIndex=e.length-1:this.currentModeIndex--,l(e[this.currentModeIndex].showText),e[this.currentModeIndex].function()},currentMode:function(){i(),l(e[this.currentModeIndex].showText),e[this.currentModeIndex].function()},resetMode:function(){this.currentModeIndex=0,i(),l(e[this.currentModeIndex].showText),e[this.currentModeIndex].function()}},o=document.createElement("canvas"),_=(o.className="finalImage",o.getContext("2d"));function l(a){$(".currentModeShowLabel").text("模式："+a)}function g(a,t,n){return a.getImageData(0,0,t,n)}function i(){o.width=f.width,o.height=f.height,_.clearRect(0,0,f.width,f.height),_.drawImage(f,0,0)}document.getElementsByClassName("handle-container")[0].appendChild(o),$(".selectImageButton").click(function(){$(".imgFileSelector").val(""),$(".imgFileSelector").click()}),$(".switchLeft").click(function(){d.previousMode()}),$(".switchRight").click(function(){d.nextMode()}),$(".imgFileSelector").change(function(a){t.readAsDataURL(a.target.files[0])}),$(document).keydown(function(a){n&&(37==a.keyCode?$(".switchLeft").click():39==a.keyCode&&$(".switchRight").click())}),t.onload=function(a){f.src=a.target.result,$(".handle-container").show()},f.onload=function(){d.currentMode(),n=!0},Math.randomInt=function(a,t){return Math.round(Math.random()*(t-a))+a}});